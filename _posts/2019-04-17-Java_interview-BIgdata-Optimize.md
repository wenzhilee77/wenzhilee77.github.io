---
layout: post
title:  软件项目随着数据量的不断增加，有什么优化方案
categories: Cache MySQL ES
tags:  Cache MySQL ES
author: wenzhilee77
---

随着软件项目中的数据量不断增加，有哪些方法可以让我们的系统依然运行的非常的流畅，响应时间很短呢？让我们看一下：

# 单体架构

下面这个架构，大家一定很不陌生，大部分小项目都是这样的架构：所有的代码都放在一个代码包中，部署在一台服务器上，数据库也只有一个。

![](/images/optimize/001jpg)

单体架构简单，最容易实现；但当这台服务器出现故障的时候，则无法对外提供服务，可用性差，难以扩展。

# 本地缓存

当数据开始增加，SQL 执行地越来越慢；我们可以将频繁读取但是变化不多的数据保存到缓存中，这样可以极大地减少数据库的压力，提高应用的响应速度；

![](/images/optimize/002.jpg)

常用的缓存淘汰策略：先进先出、最少使用、最近最少使用等等；

常用的本地缓存框架：如果使用 Spring Boot 的话，可以直接使用 @Cacheable 注解使用本地缓存（默认使用 ConcurrentHashMap 实现本地缓存）、EhCache、Caffeine。

# 分布式缓存

当然本地缓存也有很多的弊端，比如单个服务器资源有限、缓存数据无法共享、生命周期小于等于应用的生命周期等等；所以我们可以引入分布式缓存，比如 Memcached 、 Redis。

![](/images/optimize/003.jpg)

# 读写分离

因为并不是所有的数据都适合放在缓存中，所以随着数据的进一步增加，需要提高数据库本身的性能和高可用，最简单的方法：数据库的读写分离。
![](/images/optimize/004.jpg)

# 分库分表

当数据库中的数据进一步增加，单台数据库无法支撑，可以考虑分库分表；每一条数据根据路由策略，存储在不同的数据库中；

![](/images/optimize/005.jpg)

分库分表虽然突破了单台数据库的资源限制，理论上可以支撑无限增长的数据，但是也会带来新的难题：

现有的数据分片不够的话，就需要做数据库的扩充，要么需要做数据迁移，要么会让数据路由算法变得更加复杂；

全量的数据查询和统计成了一个很大的难题；

# 分库分表 + ES

针对分库分表后全量查询的难题，通常我们可以引入 ES 做全量的数据检索。

![](/images/optimize/006.jpg)

上面就是针对“数据量不断增加”的一些解决方法，当然我们也需要结合项目实际情况进行架构设计，这是一个迭代演化的过程，避免过度设计。



# 参考

https://mp.weixin.qq.com/s/aoK61i9zduSoz2vv3wlmJA